{% extends "system/base.html" %}

{% load static %}

{% block title %}设备配置{% endblock %}

{% block css %}
<link href="{% static  "system/css/main.css" %}" rel="stylesheet">
{% endblock %}

{% block content %}
    <div class="row sparse"><label class="head">设备状态&nbsp&nbsp&nbsp&nbsp</label></div>
    <div class="row">
        <div class="col-md-5" id="system">
            <div class="row tips">
                <label>系统状态</label>
            </div>
            <div class="row1 row" >
                <div class="col-md-12">
                    当前录音模式:<label id="a_mode"></label>

                </div>
            </div>
            <div class="row1 row">
                <div class="col-md-5">
                    当前用户:<label>{{ name }}:{{ permiss }}</label>

                </div>
            </div>

        </div>
        <div class="col-md-7" id="disk">
            <div class="row tips">
                <label>磁盘状态</label>

            </div>
            <div class="row1 row">
                <div class="col-md-5">
                    磁盘剩余空间:<label class="disk-info" id="space">....G</label>

                </div>
            </div>
            <div class="row1 row">
                <div class="col-md-6">
                    磁盘剩余可录制时间(单通道):<label class="disk-info"> 20h</label>

                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 col-md-offset-1 channel">
            <div class="row">
                <div class="col-md-8">
                    <label>通道号：1</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label id="c1_name">通道名：1</label>
                    <div class="row channel_in_off" id="channel1">

                    </div>

                </div>
                <div class="col-md-1 col-md-offset-1">
                    <a class="btn btn-danger record"  id="record1">
                            <span class="glyphicon glyphicon-record" aria-hidden="true"></span>
                    </a>
                </div>
                <div class="col-md-2 ">
                    <a class="btn btn-default stop"  disabled="disabled"  id="stop1">
                            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
        </div>

    </div>
    <div class="row">
    <div class="col-md-6 col-md-offset-1 channel">
        <div class="row">
            <div class="col-md-8">
                <label>通道号：2</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label id="c2_name">通道名：2</label>
                <div class="row channel_in_off" id="channel2">

                </div>

            </div>
            <div class="col-md-1 col-md-offset-1">
                <a class="btn btn-danger record" id="record2">
                        <span class="glyphicon glyphicon-record" aria-hidden="true"></span>
                </a>
            </div>
            <div class="col-md-2 ">
                <a class="btn btn-default stop" disabled="disabled" id="stop2">
                        <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                </a>
            </div>
        </div>
    </div>

    </div>
    <div class="row">
        <div class="col-md-6 col-md-offset-1 channel">
            <div class="row">
                <div class="col-md-8">
                    <label>通道号：3</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label id="c3_name">通道名：3</label>
                    <div class="row channel_in_off" id="channel3">

                    </div>

                </div>
                <div class="col-md-1 col-md-offset-1">
                    <a class="btn btn-danger record" id="record3">
                            <span class="glyphicon glyphicon-record" aria-hidden="true"></span>
                    </a>
                </div>
                <div class="col-md-2 ">
                    <a class="btn btn-default stop" disabled="disabled" id="stop3">
                            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                    </a>
                </div>
            </div>
        </div>

    </div>
    <div class="row">
    <div class="col-md-6 col-md-offset-1 channel">
        <div class="row">
            <div class="col-md-8">
                <label>通道号：4</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label id="c4_name" >通道名：4</label>
                <div class="row channel_in_off" id="channel4">

                </div>

            </div>
            <div class="col-md-1 col-md-offset-1">
                <a class="btn btn-danger record" id="record4">
                        <span class="glyphicon glyphicon-record" aria-hidden="true"></span>
                </a>
            </div>
            <div class="col-md-2 ">
                <a class="btn btn-default stop" disabled="disabled" id="stop4">
                        <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                </a>
            </div>
        </div>
    </div>

    </div>


{% endblock %}

{% block js %}
<script type="text/javascript">
    $('label#a_mode').html('{{ audiomode }}')
    $('label#c1_name').html('通道名：{{ channel1 }}')
    $('label#c2_name').html('通道名：{{ channel2 }}')
    $('label#c3_name').html('通道名：{{ channel3 }}')
    $('label#c4_name').html('通道名：{{ channel4 }}')
    var no = 0

    function getdiskStatus(){
        $.get('getdiskStatus').done(function (info) {
            if(no == info.no){

            }else{
                $('label#space').html(info.no + 'G')
                no = info.no
            }

        }).fail(function () {

        })
    }
    setInterval(getdiskStatus,3000)

    $('#editmode').click(function () {
         var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 3, "audioType": 1, "recordType": 0, "recordTime": 20, "nDevNo": 0, "nCapNo": 0,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
    })

    $('#record1').click(function () {
        $('#record1').attr('disabled','disabled')
        $('#stop1').removeAttr('disabled')
        $('#channel1').attr('class','row channel_in')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 1, "audioType": 1, "recordType": 0, "recordTime": 20, "nDevNo": 1, "nCapNo": 0,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+":";
        var s = (date.getSeconds()< 10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s;
        var dict = {"name":"{{ name }}","start_time":time,"channel_name":"通道一"}

        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })

    })

    $('#stop1').click(function () {
        $(this).attr('disabled','disabled')
        $('#record1').removeAttr('disabled')
        $('#channel1').attr('class','row channel_in_off')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 2, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 1, "nCapNo": 0,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+":";
        var s = (date.getSeconds()< 10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s
        var dict = {"end_time":time,"channel_name":"通道一","name":"{{ name }}"}

        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })

    })

    $('#record2').click(function () {
        $(this).attr('disabled','disabled')
        $('#stop2').removeAttr('disabled')
        $('#channel2').attr('class','row channel_in')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 1, "audioType": 1, "recordType": 0, "recordTime": 20, "nDevNo": 1, "nCapNo": 1,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+':';
        var s = (date.getSeconds() <10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s
        var dict = {"name":"{{ name }}","start_time":time,"channel_name":"通道二"}

        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })

    })

    $('#stop2').click(function () {
        $(this).attr('disabled','disabled')
        $('#record2').removeAttr('disabled')
        $('#channel2').attr('class','row channel_in_off')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 2, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 1, "nCapNo": 1,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+':';
        var s = (date.getSeconds() <10 ? '0'+date.getSeconds():date.getSeconds());
        var time = Y+M+D+" "+h+m+s
        var dict = {"end_time":time,"channel_name":"通道二","name":"{{ name }}"}
        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })
    })

    $('#record3').click(function () {
        $(this).attr('disabled','disabled')
        $('#stop3').removeAttr('disabled')
        $('#channel3').attr('class','row channel_in')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 1, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 0, "nCapNo": 0,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+':';
        var time = Y+M+D+" "+h+m+s
        var dict = {"name":"{{ name }}","start_time":time,"channel_name":"通道三"}
        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })

    })

    $('#stop3').click(function () {
        $(this).attr('disabled','disabled')
        $('#record3').removeAttr('disabled')
        $('#channel3').attr('class','row channel_in_off')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 2, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 0, "nCapNo": 0,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+":";
        var s = (date.getSeconds()< 10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s
        var dict = {"end_time":time,"channel_name":"通道三","name":"{{ name }}"}
        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })
    })

    $('#record4').click(function () {
        $(this).attr('disabled','disabled')
        $('#stop4').removeAttr('disabled')
        $('#channel4').attr('class','row channel_in')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 1, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 0, "nCapNo": 1,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+':';
        var s = (date.getSeconds()<10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s
        var dict = {"name":"{{ name }}","start_time":time,"channel_name":"通道四"}

        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })

    })

    $('#stop4').click(function () {
        $(this).attr('disabled','disabled')
        $('#record4').removeAttr('disabled')
        $('#channel4').attr('class','row channel_in_off')
        var data = {"cmdCheck": 0x02, "Seq": 0x15,
        "audioPara": {"audioFunc": 2, "audioType": 1, "recordType": 0, "recordTime": 2, "nDevNo": 0, "nCapNo": 1,
                      "mp3Bps": 128, "sampleRate": 48000, "timeInterval": 10, "fileName": "new.mp3",
                      "isStereoSaveFlag": 0}}
        var jsonstr = JSON.stringify(data);
        $.post('sendData',{"mes":jsonstr}).done(function (info) {


        }).fail(function () {

        })
        var timestamp = Date.parse(new Date());
        var timestamp = timestamp / 1000;
        var date = new Date(timestamp * 1000);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
        var Y = date.getFullYear() + '-';
        var M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1):date.getMonth()+1) + '-';
        var D = (date.getDate()< 10 ? '0'+date.getDate():date.getDate());
        var h = (date.getHours() < 10 ? '0'+date.getHours():date.getHours())+ ':';
        var m = (date.getMinutes() < 10 ? '0'+date.getMinutes():date.getMinutes())+":";
        var s = (date.getSeconds() <10 ? '0'+date.getSeconds():date.getSeconds())
        var time = Y+M+D+" "+h+m+s
        var dict = {"end_time":time,"channel_name":"通道四","name":"{{ name }}"}
        var json_dict = JSON.stringify(dict)
        $.post('free_log',{"mes":json_dict}).done(function (info) {


        }).fail(function () {

        })
    })
</script>
{% endblock %}

